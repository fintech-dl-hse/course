{
  "meta": {
    "device": "cuda",
    "dtype": "torch.bfloat16",
    "model_name": "unsloth/Meta-Llama-3.1-8B",
    "hidden_size": 4096,
    "num_layers": 32,
    "num_attention_heads": 32,
    "cwd": "/mnt/virtual_ai0001053-00054_SR004-nfs2/d.tarasov/fintech-dl-hse/course"
  },
  "prefix_lengths": [
    10000,
    50000,
    100000
  ],
  "trials": 10,
  "warmup": 2,
  "calibration_lengths": [
    4096,
    8192,
    16384
  ],
  "with_kv_cache": {
    "method": "measured_or_estimated",
    "per_prefix": {
      "10000": {
        "times_ms": [
          50.74087344110012,
          51.20376497507095,
          50.99467467516661,
          50.86677521467209,
          51.099784672260284,
          50.97665544599295,
          51.310304552316666,
          51.18798557668924,
          50.72539485991001,
          50.57552456855774
        ],
        "mean_ms": 50.968173798173666,
        "stdev_ms": 0.22672266891287088
      },
      "50000": {
        "times_ms": [
          180.39687350392342,
          180.87828159332275,
          180.94518315047026,
          180.85314240306616,
          180.6533019989729,
          181.10511358827353,
          180.73386326432228,
          180.7392630726099,
          180.49599323421717,
          180.66458217799664
        ],
        "mean_ms": 180.7465597987175,
        "stdev_ms": 0.19935356488218842
      },
      "100000": {
        "times_ms": [
          350.93500278890133,
          351.72997135668993,
          351.25825088471174,
          351.38549096882343,
          350.57856142520905,
          351.37343127280474,
          350.6920523941517,
          351.4491906389594,
          350.90390127152205,
          350.8804515004158
        ],
        "mean_ms": 351.1186304502189,
        "stdev_ms": 0.3533892957660886
      }
    }
  },
  "without_kv_cache": {
    "method": "estimated_from_linear_fit",
    "fit_per_trial": [
      {
        "a_per_token_ms": 9.624874865364421e-05,
        "b_ms": 0.6177025206852704,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0099771607201546
          },
          {
            "n": 8192,
            "per_layer_ms": 1.4091126213315874
          },
          {
            "n": 16384,
            "per_layer_ms": 2.193661901401356
          }
        ]
      },
      {
        "a_per_token_ms": 9.712341762581542e-05,
        "b_ms": 0.6030371587257832,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9940496529452503
          },
          {
            "n": 8192,
            "per_layer_ms": 1.4088797324802727
          },
          {
            "n": 16384,
            "per_layer_ms": 2.1909047209192067
          }
        ]
      },
      {
        "a_per_token_ms": 9.610849107031884e-05,
        "b_ms": 0.6312489422271028,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0213490459136665
          },
          {
            "n": 8192,
            "per_layer_ms": 1.4239101146813482
          },
          {
            "n": 16384,
            "per_layer_ms": 2.2041103220544755
          }
        ]
      },
      {
        "a_per_token_ms": 9.642056143986468e-05,
        "b_ms": 0.62016629090067,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.012654072837904
          },
          {
            "n": 8192,
            "per_layer_ms": 1.4137197867967188
          },
          {
            "n": 16384,
            "per_layer_ms": 2.198695350671187
          }
        ]
      },
      {
        "a_per_token_ms": 9.743341371810337e-05,
        "b_ms": 0.6103970372350886,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0099021601490676
          },
          {
            "n": 8192,
            "per_layer_ms": 1.40794477192685
          },
          {
            "n": 16384,
            "per_layer_ms": 2.206955017754808
          }
        ]
      },
      {
        "a_per_token_ms": 9.736213054826035e-05,
        "b_ms": 0.6017026898916811,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.003224664600566
          },
          {
            "n": 8192,
            "per_layer_ms": 1.395203231368214
          },
          {
            "n": 16384,
            "per_layer_ms": 2.198247180785984
          }
        ]
      },
      {
        "a_per_token_ms": 9.629521358078819e-05,
        "b_ms": 0.6244108226383105,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.012816559523344
          },
          {
            "n": 8192,
            "per_layer_ms": 1.4222903992049396
          },
          {
            "n": 16384,
            "per_layer_ms": 2.1991018729750067
          }
        ]
      },
      {
        "a_per_token_ms": 9.629579470323993e-05,
        "b_ms": 0.6230938306543976,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.016097521642223
          },
          {
            "n": 8192,
            "per_layer_ms": 1.4140848070383072
          },
          {
            "n": 16384,
            "per_layer_ms": 2.200092189013958
          }
        ]
      },
      {
        "a_per_token_ms": 9.541711979263059e-05,
        "b_ms": 0.6390619237208739,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.026984682539478
          },
          {
            "n": 8192,
            "per_layer_ms": 1.42507761484012
          },
          {
            "n": 16384,
            "per_layer_ms": 2.200923132477328
          }
        ]
      },
      {
        "a_per_token_ms": 9.626181553455484e-05,
        "b_ms": 0.621491577476263,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0144371481146663
          },
          {
            "n": 8192,
            "per_layer_ms": 1.4120826090220362
          },
          {
            "n": 16384,
            "per_layer_ms": 2.197973750298843
          }
        ]
      }
    ],
    "per_prefix": {
      "10000": {
        "times_ms": [
          351678.20426490187,
          348384.8987403754,
          355788.62458375434,
          352741.5386818283,
          351236.1032103887,
          348339.8475834422,
          353899.2122076934,
          353478.7046617436,
          357182.47399805544,
          352911.6115381775
        ],
        "mean_ms": 352564.12194703607,
        "stdev_ms": 2689.9187830796927
      },
      "50000": {
        "times_ms": [
          4838350.978241123,
          4849873.857727971,
          4854414.837168975,
          4849165.659484811,
          4874049.75503125,
          4857287.415461542,
          4850942.8956236895,
          4848858.953812396,
          4839260.2033544555,
          4844936.154796641
        ],
        "mean_ms": 4850714.0710702855,
        "stdev_ms": 9620.174094912
      },
      "100000": {
        "times_ms": [
          17376601.848773785,
          17469621.125521176,
          17397508.959963456,
          17411976.234158795,
          17542772.60751077,
          17503545.27478391,
          17405502.87771043,
          17401381.483883984,
          17311889.99011936,
          17390817.55235767
        ],
        "mean_ms": 17421161.795478337,
        "stdev_ms": 63286.267798196226
      }
    }
  },
  "kv_cache_size": {
    "bytes_per_token": 131072,
    "per_prefix_bytes": {
      "100000": 13107200000,
      "50000": 6553600000,
      "10000": 1310720000
    }
  }
}