{
  "meta": {
    "device": "cuda",
    "dtype": "torch.bfloat16",
    "model_name": "unsloth/Llama-3.2-1B",
    "hidden_size": 2048,
    "num_layers": 16,
    "num_attention_heads": 32,
    "cwd": "/mnt/virtual_ai0001053-00054_SR004-nfs2/d.tarasov/fintech-dl-hse/course"
  },
  "prefix_lengths": [
    10000,
    50000,
    100000,
    150000,
    200000
  ],
  "trials": 10,
  "warmup": 2,
  "calibration_lengths": [
    4096,
    8192,
    16384
  ],
  "with_kv_cache": {
    "method": "measured_or_estimated",
    "per_prefix": {
      "10000": {
        "times_ms": [
          23.071106523275375,
          23.231266997754574,
          23.270906880497932,
          23.47839716821909,
          23.8749161362648,
          23.40080589056015,
          23.390937596559525,
          23.41341692954302,
          23.251057602465153,
          23.457637056708336
        ],
        "mean_ms": 23.384044878184795,
        "stdev_ms": 0.20204485408768122
      },
      "50000": {
        "times_ms": [
          83.47016386687756,
          96.12950775772333,
          99.5012279599905,
          91.78886655718088,
          98.68117794394493,
          97.50359784811735,
          93.36339682340622,
          99.12711847573519,
          95.85268702358007,
          92.91548747569323
        ],
        "mean_ms": 94.83332317322493,
        "stdev_ms": 4.572859567662409
      },
      "100000": {
        "times_ms": [
          161.9594870135188,
          167.3302287235856,
          167.6133880391717,
          167.66247898340225,
          168.5022385790944,
          168.27877797186375,
          167.474209330976,
          167.060567997396,
          167.33688861131668,
          167.25726798176765
        ],
        "mean_ms": 167.04755332320929,
        "stdev_ms": 1.7495299326946974
      },
      "150000": {
        "times_ms": [
          242.5718903541565,
          243.36254969239235,
          243.3255799114704,
          242.84449964761734,
          243.29484067857265,
          243.2165900245309,
          242.86589957773685,
          243.08943934738636,
          242.96593014150858,
          243.25260054320097
        ],
        "mean_ms": 243.0789819918573,
        "stdev_ms": 0.24643733697379913
      },
      "200000": {
        "times_ms": [
          320.38638181984425,
          322.86524306982756,
          321.9872321933508,
          322.23194278776646,
          322.2131012007594,
          321.8031032010913,
          322.10788130760193,
          322.0614232122898,
          322.3379226401448,
          321.7723425477743
        ],
        "mean_ms": 321.97665739804506,
        "stdev_ms": 0.6055189666093757
      }
    }
  },
  "without_kv_cache": {
    "method": "estimated_from_linear_fit",
    "fit_per_trial": [
      {
        "a_per_token_ms": 8.297653611829705e-05,
        "b_ms": 0.6517751899082214,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.023179094772786
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2842209544032812
          },
          {
            "n": 16384,
            "per_layer_ms": 2.0270287641324103
          }
        ]
      },
      {
        "a_per_token_ms": 8.561900496520789e-05,
        "b_ms": 0.6705814739689231,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0365178459323943
          },
          {
            "n": 8192,
            "per_layer_ms": 1.3491109712049365
          },
          {
            "n": 16384,
            "per_layer_ms": 2.080983715131879
          }
        ]
      },
      {
        "a_per_token_ms": 9.059042684254694e-05,
        "b_ms": 0.5728973192162812,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9580352925695479
          },
          {
            "n": 8192,
            "per_layer_ms": 1.293894718401134
          },
          {
            "n": 16384,
            "per_layer_ms": 2.0641706651076674
          }
        ]
      },
      {
        "a_per_token_ms": 8.648534028614969e-05,
        "b_ms": 0.6401939026545733,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0377796716056764
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2836690875701606
          },
          {
            "n": 16384,
            "per_layer_ms": 2.078840625472367
          }
        ]
      },
      {
        "a_per_token_ms": 8.916537451243909e-05,
        "b_ms": 0.5997676053084433,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9732277248986065
          },
          {
            "n": 8192,
            "per_layer_ms": 1.3178522349335253
          },
          {
            "n": 16384,
            "per_layer_ms": 2.064772474113852
          }
        ]
      },
      {
        "a_per_token_ms": 8.378582094792364e-05,
        "b_ms": 0.6594289443455637,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0366340866312385
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2947747600264847
          },
          {
            "n": 16384,
            "per_layer_ms": 2.0491850445978343
          }
        ]
      },
      {
        "a_per_token_ms": 8.265422479780682e-05,
        "b_ms": 0.6929070805199444,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0654096840880811
          },
          {
            "n": 8192,
            "per_layer_ms": 1.319084141869098
          },
          {
            "n": 16384,
            "per_layer_ms": 2.0640893490053713
          }
        ]
      },
      {
        "a_per_token_ms": 8.280128582782709e-05,
        "b_ms": 0.6989249086473137,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0756978299468756
          },
          {
            "n": 8192,
            "per_layer_ms": 1.3208047603257
          },
          {
            "n": 16384,
            "per_layer_ms": 2.0743506029248238
          }
        ]
      },
      {
        "a_per_token_ms": 8.795289626764966e-05,
        "b_ms": 0.6145648658275604,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0013934224843979
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2952147517353296
          },
          {
            "n": 16384,
            "per_layer_ms": 2.0688718650490046
          }
        ]
      },
      {
        "a_per_token_ms": 8.506188363201415e-05,
        "b_ms": 0.6475046102423221,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 1.0230547050014138
          },
          {
            "n": 8192,
            "per_layer_ms": 1.3036266318522394
          },
          {
            "n": 16384,
            "per_layer_ms": 2.054726821370423
          }
        ]
      }
    ],
    "per_prefix": {
      "10000": {
        "times_ms": [
          170671.89740284253,
          175795.08932759124,
          164143.15978278994,
          171626.21548087438,
          167302.24968926318,
          172543.99071930494,
          176995.1250594204,
          178075.63814869808,
          168699.7317782308,
          171657.0494950734
        ],
        "mean_ms": 171751.01468840888,
        "stdev_ms": 4155.178675664037
      },
      "50000": {
        "times_ms": [
          2180984.0649069655,
          2248879.526081282,
          2270162.6283947006,
          2241896.521982767,
          2263157.2406453416,
          2203293.088763303,
          2207443.2220620112,
          2215198.763988724,
          2250744.9991735485,
          2219275.3855875935
        ],
        "mean_ms": 2230103.5441586236,
        "stdev_ms": 27566.962142129956
      },
      "100000": {
        "times_ms": [
          7681029.574545813,
          7922519.25077088,
          8163942.330491279,
          7943206.655411522,
          8092929.461788247,
          7758019.015443551,
          7721055.436036295,
          7742448.961090531,
          8019605.849053083,
          7841026.116455753
        ],
        "mean_ms": 7888578.265108695,
        "stdev_ms": 158332.02916647936
      },
      "150000": {
        "times_ms": [
          16500136.528916543,
          17020919.174068794,
          17681339.106289737,
          17103930.400286265,
          17489316.663428716,
          16664177.780040745,
          16540836.641922852,
          16581750.591305422,
          17306582.549638607,
          16865252.19260448
        ],
        "mean_ms": 16975424.162850216,
        "stdev_ms": 396157.372625676
      },
      "200000": {
        "times_ms": [
          28638304.928019155,
          29544079.295975022,
          30822352.95579007,
          29724067.756606996,
          30452318.84556675,
          28921769.382554885,
          28666786.83972168,
          28733103.654633395,
          30111675.100930113,
          29291953.61403377
        ],
        "mean_ms": 29490641.23738318,
        "stdev_ms": 740504.891925221
      }
    }
  },
  "kv_cache_size": {
    "bytes_per_token": 32768,
    "per_prefix_bytes": {
      "10000": 327680000,
      "50000": 1638400000,
      "100000": 3276800000,
      "150000": 4915200000,
      "200000": 6553600000
    }
  }
}