{
  "meta": {
    "device": "cuda",
    "dtype": "torch.bfloat16",
    "model_name": "unsloth/Llama-3.2-3B",
    "hidden_size": 3072,
    "num_layers": 28,
    "num_attention_heads": 24,
    "cwd": "/mnt/virtual_ai0001053-00054_SR004-nfs2/d.tarasov/fintech-dl-hse/course"
  },
  "prefix_lengths": [
    10000,
    50000,
    100000
  ],
  "trials": 10,
  "warmup": 2,
  "calibration_lengths": [
    4096,
    8192,
    16384
  ],
  "with_kv_cache": {
    "method": "measured_or_estimated",
    "per_prefix": {
      "10000": {
        "times_ms": [
          39.86461088061333,
          39.408791810274124,
          38.93720172345638,
          38.44300005584955,
          38.744112476706505,
          39.75573182106018,
          39.0232615172863,
          38.83305098861456,
          38.985210470855236,
          39.02237117290497
        ],
        "mean_ms": 39.101734291762114,
        "stdev_ms": 0.42321364571784914
      },
      "50000": {
        "times_ms": [
          141.9505812227726,
          142.26657152175903,
          142.42724981158972,
          142.51610916107893,
          142.0712312683463,
          141.79273135960102,
          142.5880817696452,
          141.9901605695486,
          141.80768094956875,
          142.0391909778118
        ],
        "mean_ms": 142.1449588611722,
        "stdev_ms": 0.2729059654990266
      },
      "100000": {
        "times_ms": [
          277.8218500316143,
          322.94000312685966,
          278.2797394320369,
          278.30821089446545,
          277.2004399448633,
          278.35399098694324,
          278.229471296072,
          278.31901982426643,
          278.1624300405383,
          278.4609906375408
        ],
        "mean_ms": 282.60761462152004,
        "stdev_ms": 13.448664149516173
      }
    }
  },
  "without_kv_cache": {
    "method": "estimated_from_linear_fit",
    "fit_per_trial": [
      {
        "a_per_token_ms": 8.420804661278567e-05,
        "b_ms": 0.5428169554631621,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9040359873324633
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2081949639001064
          },
          {
            "n": 16384,
            "per_layer_ms": 1.9306330276387078
          }
        ]
      },
      {
        "a_per_token_ms": 8.203701779574642e-05,
        "b_ms": 0.5880101484113501,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9574227567229953
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2099739230637039
          },
          {
            "n": 16384,
            "per_layer_ms": 1.9487991396869933
          }
        ]
      },
      {
        "a_per_token_ms": 8.196093577977556e-05,
        "b_ms": 0.5994094369400832,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9642956179699728
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2270721407341105
          },
          {
            "n": 16384,
            "per_layer_ms": 1.956844502793891
          }
        ]
      },
      {
        "a_per_token_ms": 8.134669449608905e-05,
        "b_ms": 0.5790094645427803,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9410420565732888
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2021467887929507
          },
          {
            "n": 16384,
            "per_layer_ms": 1.926211972853967
          }
        ]
      },
      {
        "a_per_token_ms": 8.012494787385083e-05,
        "b_ms": 0.6165751422356284,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9832441740270171
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2152428472680705
          },
          {
            "n": 16384,
            "per_layer_ms": 1.9485809108508485
          }
        ]
      },
      {
        "a_per_token_ms": 8.511259883729204e-05,
        "b_ms": 0.5440916200833668,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9092588443309069
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2165150006434746
          },
          {
            "n": 16384,
            "per_layer_ms": 1.9468494491385562
          }
        ]
      },
      {
        "a_per_token_ms": 8.22604814560208e-05,
        "b_ms": 0.5790297873318199,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9511474054306746
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2001396223370517
          },
          {
            "n": 16384,
            "per_layer_ms": 1.9443748585347618
          }
        ]
      },
      {
        "a_per_token_ms": 7.986079070605586e-05,
        "b_ms": 0.610500890096383,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9710274503699371
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2145953452480691
          },
          {
            "n": 16384,
            "per_layer_ms": 1.9356484657951765
          }
        ]
      },
      {
        "a_per_token_ms": 8.115396688444141e-05,
        "b_ms": 0.5849860774885336,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9429234944816146
          },
          {
            "n": 8192,
            "per_layer_ms": 1.2115032212542636
          },
          {
            "n": 16384,
            "per_layer_ms": 1.9273780552404267
          }
        ]
      },
      {
        "a_per_token_ms": 8.564862067645169e-05,
        "b_ms": 0.5323485737400407,
        "calibration_points": [
          {
            "n": 4096,
            "per_layer_ms": 0.9074724345867123
          },
          {
            "n": 8192,
            "per_layer_ms": 1.1975214084876435
          },
          {
            "n": 16384,
            "per_layer_ms": 1.947769130180989
          }
        ]
      }
    ],
    "per_prefix": {
      "10000": {
        "times_ms": [
          269891.8019141111,
          279506.1516517144,
          282591.4269659182,
          276019.41090373264,
          284827.18434206943,
          271515.2077593888,
          277304.53095874254,
          282756.5367261643,
          277423.01689037116,
          268977.6604011385
        ],
        "mean_ms": 277081.2928513351,
        "stdev_ms": 5273.347059550289
      },
      "50000": {
        "times_ms": [
          3707284.314728554,
          3694567.2565394724,
          3707863.3366633076,
          3657804.500409157,
          3667634.4621781707,
          3740728.806241121,
          3689816.135562295,
          3649884.823400385,
          3659426.1572162155,
          3743049.6809463394
        ],
        "mean_ms": 3691805.9473885014,
        "stdev_ms": 31740.448444245292
      },
      "100000": {
        "times_ms": [
          13309131.892352106,
          13131725.758781193,
          13152992.177910905,
          13009877.615544546,
          12944015.2755259,
          13439339.531092687,
          13137865.973046048,
          12890024.99622468,
          12999629.99634333,
          13481502.8092443
        ],
        "mean_ms": 13149610.602606568,
        "stdev_ms": 192791.38601368846
      }
    }
  },
  "kv_cache_size": {
    "bytes_per_token": 114688,
    "per_prefix_bytes": {
      "100000": 11468800000,
      "50000": 5734400000,
      "10000": 1146880000
    }
  }
}